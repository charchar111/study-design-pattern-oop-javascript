# 컨셉

## 목적

데코레이터 패턴 공부용

# 내용

## 기존 상황

스타버즈 커피점에는 기존에 4가지 종류의 커피를 팔았습니다.

- houseblend
- darkroast
- decaf
- espessso

이들은 `Beverage` 라는 추상 클래스에서 getDescription을 상속받고 cost를 구상 위임 받았습니다.

## 요구사항1

여기에 첨가물 옵션을 자유롭게 추가할 수 있게 되었습니다.

- 두유(soy)
- 우유(milk)
- 모카(mocha)
- 휘핑크림(whip)

이 추가 기능을 구현해주세요.

## 요구사항2

기존의 음료 클래스를 수정하지 않으면서 동작을 추가할 수 있어야 유지 보수에서 바람직합니다.

즉, OCP 원칙에 따라, 기능을 추가하거나 변경할 때 기존의 음료 클래스를 수정하지 않으면서 동적으로 getDescription과 cost 기능을 꾸밀 수 있어야 합니다.

## 분석

### 방법1. 부모 클래스에 공통 상태 혹은 기능 추가

- 한 가지 방법은 추상 클래스인 Beverage에 첨가물 계산 기능을 추가하는 것이다.
  - 상태: soy, milk, mocha, whiip 추가
  - 이들의 추가 여부를 체크하는 has, 그리고 getter, setter 추가

#### 한계

- 이 방식에는 문제가 있다.

- 구현에 대한 강한 결합

  - cost에서 첨가물의 상태에 따라 분기 처리 및 계산을 하는 로직을 부모가 가지고 있으면 자식은 그 첨가물 로직에 강하게 결합됨
  - 기능 요구 사항에 따라 변경 시 모든 자식이 영향

- 불완전 상속 관계

  - 만약 구상 클래스인 각 음료가 이 첨가물 계산 로직이 필요없거나 변형이 필요한 경우, 구상 클래스 단에서 공통 기능을 오버라이드, 분기처리 => 외부에서 클래스의 동작을 예측하기 어려워짐

- 이 문제는 1장. `strategy-pattern` 때와 동일한 딜레마다. 이 문제에 대해 현대 OOP는 공통 기능을 상속 대신, 조합 방식으로 해결하라 권고한다.
  - 상속은 추상적 수준의 객체 수준에서만 권장되며, 구체적인 기능을 재사용하는 용도로는 쓰지 않아야 한다.
